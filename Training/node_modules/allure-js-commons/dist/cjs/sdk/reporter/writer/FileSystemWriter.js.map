{"version":3,"file":"FileSystemWriter.js","names":["_nodeFs","require","_nodePath","_utils","writeJson","path","data","writeFileSync","JSON","stringify","FileSystemWriter","constructor","config","writeAttachment","distFileName","content","buildPath","writeAttachmentFromPath","from","to","copyFileSync","writeEnvironmentInfo","info","text","stringifyProperties","unicode","toString","writeCategoriesDefinitions","categories","writeGroup","result","concat","uuid","writeResult","name","mkdirSync","resultsDir","recursive","join","exports"],"sources":["../../../../../src/sdk/reporter/writer/FileSystemWriter.ts"],"sourcesContent":["import { copyFileSync, mkdirSync, writeFileSync } from \"node:fs\";\nimport { join } from \"node:path\";\nimport type { TestResult, TestResultContainer } from \"../../../model.js\";\nimport type { Category, EnvironmentInfo } from \"../../types.js\";\nimport type { Writer } from \"../types.js\";\nimport { stringifyProperties } from \"../utils.js\";\n\nconst writeJson = (path: string, data: unknown): void => {\n  writeFileSync(path, JSON.stringify(data), \"utf-8\");\n};\n\nexport class FileSystemWriter implements Writer {\n  constructor(private config: { resultsDir: string }) {}\n\n  writeAttachment(distFileName: string, content: Buffer): void {\n    const path = this.buildPath(distFileName);\n\n    writeFileSync(path, content, \"utf-8\");\n  }\n\n  writeAttachmentFromPath(distFileName: string, from: string): void {\n    const to = this.buildPath(distFileName);\n\n    copyFileSync(from, to);\n  }\n\n  writeEnvironmentInfo(info: EnvironmentInfo): void {\n    const text = stringifyProperties(info, { unicode: true }).toString();\n    const path = this.buildPath(\"environment.properties\");\n\n    writeFileSync(path, text);\n  }\n\n  writeCategoriesDefinitions(categories: Category[]): void {\n    const path = this.buildPath(\"categories.json\");\n\n    writeJson(path, categories);\n  }\n\n  writeGroup(result: TestResultContainer): void {\n    const path = this.buildPath(`${result.uuid}-container.json`);\n    writeJson(path, result);\n  }\n\n  writeResult(result: TestResult): void {\n    const path = this.buildPath(`${result.uuid}-result.json`);\n    writeJson(path, result);\n  }\n\n  private buildPath(name: string): string {\n    mkdirSync(this.config.resultsDir, {\n      recursive: true,\n    });\n    return join(this.config.resultsDir, name);\n  }\n}\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AACA,IAAAC,SAAA,GAAAD,OAAA;AAIA,IAAAE,MAAA,GAAAF,OAAA;AAEA,IAAMG,SAAS,GAAGA,CAACC,IAAY,EAAEC,IAAa,KAAW;EACvD,IAAAC,qBAAa,EAACF,IAAI,EAAEG,IAAI,CAACC,SAAS,CAACH,IAAI,CAAC,EAAE,OAAO,CAAC;AACpD,CAAC;AAEM,MAAMI,gBAAgB,CAAmB;EAC9CC,WAAWA,CAASC,MAA8B,EAAE;IAAA,KAAhCA,MAA8B,GAA9BA,MAA8B;EAAG;EAErDC,eAAeA,CAACC,YAAoB,EAAEC,OAAe,EAAQ;IAC3D,IAAMV,IAAI,GAAG,IAAI,CAACW,SAAS,CAACF,YAAY,CAAC;IAEzC,IAAAP,qBAAa,EAACF,IAAI,EAAEU,OAAO,EAAE,OAAO,CAAC;EACvC;EAEAE,uBAAuBA,CAACH,YAAoB,EAAEI,IAAY,EAAQ;IAChE,IAAMC,EAAE,GAAG,IAAI,CAACH,SAAS,CAACF,YAAY,CAAC;IAEvC,IAAAM,oBAAY,EAACF,IAAI,EAAEC,EAAE,CAAC;EACxB;EAEAE,oBAAoBA,CAACC,IAAqB,EAAQ;IAChD,IAAMC,IAAI,GAAG,IAAAC,0BAAmB,EAACF,IAAI,EAAE;MAAEG,OAAO,EAAE;IAAK,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC;IACpE,IAAMrB,IAAI,GAAG,IAAI,CAACW,SAAS,CAAC,wBAAwB,CAAC;IAErD,IAAAT,qBAAa,EAACF,IAAI,EAAEkB,IAAI,CAAC;EAC3B;EAEAI,0BAA0BA,CAACC,UAAsB,EAAQ;IACvD,IAAMvB,IAAI,GAAG,IAAI,CAACW,SAAS,CAAC,iBAAiB,CAAC;IAE9CZ,SAAS,CAACC,IAAI,EAAEuB,UAAU,CAAC;EAC7B;EAEAC,UAAUA,CAACC,MAA2B,EAAQ;IAC5C,IAAMzB,IAAI,GAAG,IAAI,CAACW,SAAS,IAAAe,MAAA,CAAID,MAAM,CAACE,IAAI,oBAAiB,CAAC;IAC5D5B,SAAS,CAACC,IAAI,EAAEyB,MAAM,CAAC;EACzB;EAEAG,WAAWA,CAACH,MAAkB,EAAQ;IACpC,IAAMzB,IAAI,GAAG,IAAI,CAACW,SAAS,IAAAe,MAAA,CAAID,MAAM,CAACE,IAAI,iBAAc,CAAC;IACzD5B,SAAS,CAACC,IAAI,EAAEyB,MAAM,CAAC;EACzB;EAEQd,SAASA,CAACkB,IAAY,EAAU;IACtC,IAAAC,iBAAS,EAAC,IAAI,CAACvB,MAAM,CAACwB,UAAU,EAAE;MAChCC,SAAS,EAAE;IACb,CAAC,CAAC;IACF,OAAO,IAAAC,cAAI,EAAC,IAAI,CAAC1B,MAAM,CAACwB,UAAU,EAAEF,IAAI,CAAC;EAC3C;AACF;AAACK,OAAA,CAAA7B,gBAAA,GAAAA,gBAAA","ignoreList":[]}